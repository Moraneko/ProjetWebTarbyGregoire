(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd621"],{"80c6":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-app",{attrs:{id:"inspire"}},[s("v-navigation-drawer",{staticClass:"primary",attrs:{app:"",clipped:"",width:"200"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[s("v-list",[s("v-list-item",{attrs:{to:{name:"Accueil"},color:"black"},on:{click:function(e){return t.retour()}}},[s("div",{staticClass:"d-flex flex-row align-center"},[s("v-icon",{attrs:{color:"white"}},[t._v("home")]),s("h3",{staticClass:"d-flex px-5",staticStyle:{color:"white"}},[t._v("Acceuil")])],1)])],1)],1),s("v-app-bar",{staticClass:"primary",attrs:{app:"","clipped-left":""}},[s("v-app-bar-nav-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),s("v-toolbar-title",[t._v("Site Tarby-Grégoire")]),s("div",{staticClass:"flex-grow-1"}),t.connected?s("v-toolbar-items",[s("v-btn",{staticClass:"pr-12",attrs:{color:"#f00000"}},[s("v-icon",{staticClass:"px-1 mr-3"},[t._v("mdi-account")]),t._v(t._s(t.userName))],1),s("v-btn",{attrs:{color:"#f00000"},on:{click:t.logout}},[s("v-icon",{staticClass:"px-1 "},[t._v("mdi-close")]),t._v("Deconnexion")],1)],1):s("v-toolbar-items",[s("v-btn",{attrs:{color:"#f00000"}},[t._v("Inscription")]),s("v-btn",{attrs:{color:"#f00000"}},[t._v("Connexion")])],1)],1),s("v-content",{staticClass:"primary"},[s("v-card",{staticClass:"primary d-flex justify-center",attrs:{tile:""}},[s("div",[s("h1",{staticClass:"d-flex justify-center"},[t._v("Nom utilisateur")]),s("h2",{staticClass:"pb-5"},[t._v("Liste de vos animes et statistiques.")])])]),s("div",{staticClass:"d-flex flex-column mx-9 px-9"},[s("v-card",{staticClass:"secondary mx-9 px-9"},[s("div",[s("h1",{staticClass:"d-flex justify-center "},[t._v("Statistiques")])]),s("div",{staticClass:"d-flex justify-space-around"},[s("h2",[t._v("TV: "+t._s(t.nbTV))]),s("h2",[t._v(" OVA: "+t._s(t.nbOAV))]),s("h2",[t._v("Film: "+t._s(t.nbFilm))]),s("h2",[t._v("Episodes: "+t._s(t.nbEp))]),s("h2",[t._v("Score moyen: "+t._s(t.mean)+" ")])])]),s("div",{staticClass:"py-2"}),t._l(t.listePerso,(function(e,a){return s("v-card",{key:a,staticClass:"secondary d-flex flex-column mx-9 my-4"},[s("userAnimeInfo",{attrs:{titre:e.anime.title,added:t.isInListPerso(e.anime.mal_id),index:a,img:e.anime.image_url,score:e.score,connected:t.connected,id:e.anime.mal_id},on:{updateScore:t.updateScore}})],1)}))],2)],1),s("v-footer",{attrs:{app:""}},[s("span",[t._v("© 2019")])])],1)},i=[],o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-card",{staticClass:" secondary d-flex align-center "},[s("v-card",{staticClass:" secondary d-flex flex-row flex-grow-1 align-center ",on:{click:function(e){return t.ouvrirOverlay()}}},[s("div",{staticClass:"d-flex px-12"},[s("v-img",{attrs:{"align-end":"",src:t.img,width:"100",height:"200",raised:"true"}})],1),t.titre.length>50?s("h2",{staticClass:"d-flex text-justify mx-auto"},[t._v(t._s(t.titre.substring(0,50))+"...")]):s("h2",{staticClass:"d-flex text-justify mx-auto"},[t._v(t._s(t.titre))])]),s("div",{staticClass:"d-flex flex-column align-center pr-9 ml-9"},[s("v-rating",{attrs:{value:t.added[1]/2,color:"amber","half-increments":"",hover:"",size:"25"},on:{input:t.updateScore}}),s("div",{staticClass:"grey--text ml-4"},[t._v(t._s(t.added[1]))])],1)],1),s("loadingOverlay",{attrs:{loading:t.loading}}),s("InfoOverlay",{attrs:{overlayVisibility:t.overlayVisibility,connected:t.connected,data:t.apiFetch,id:t.id,added:t.added},on:{fermerOverlay:t.fermerOverlay}})],1)},n=[],r=s("0730"),l=s("fb6e"),c=s("56d7"),d={props:{titre:String,img:String,score:Number,id:Number,index:Number,connected:Boolean,added:Array},components:{InfoOverlay:r["a"],loadingOverlay:l["a"]},data:()=>({overlayVisibility:!1,loading:!1,apiFetch:{}}),methods:{updateScore:function(t){this.$emit("updateScore",[2*t,this.id])},ouvrirOverlay(){this.loading=!0,fetch("https://api.jikan.moe/v3/anime/"+this.id).then(t=>{return t.json()}).then(t=>{this.apiFetch=t,this.loading=!1}).catch(t=>{console.log(t)}),this.overlayVisibility=!0},fermerOverlay(){this.overlayVisibility=!1}},created(){c["bus"].$on("delThisAnime2",t=>{t===this.id&&this.fermerOverlay()})}},m=d,u=s("2877"),p=s("6544"),v=s.n(p),h=s("b0af"),f=s("adda"),g=s("1d4d"),b=Object(u["a"])(m,o,n,!1,null,null,null),y=b.exports;v()(b,{VCard:h["a"],VImg:f["a"],VRating:g["a"]});var x=s("2b0e"),_={components:{userAnimeInfo:y},props:{source:String},data:()=>({nbTV:0,nbFilm:0,nbOAV:0,nbEp:0,mean:0,userName:sessionStorage.getItem("user"),idUser:JSON.parse(sessionStorage.getItem("idUser")),drawer:null,connected:JSON.parse(sessionStorage.getItem("connecte")),appelBool:!1,listePerso:[]}),methods:{meanScore:function(){var t=0,e=0;for(var s in this.listePerso)t+=this.listePerso[s].score,e++;this.mean=Math.trunc(t/e)},stat:function(){var t=0,e=0,s=0,a=0;for(var i in this.listePerso)a+=this.listePerso[i].anime.episodes,"TV"===this.listePerso[i].anime.type?t++:"Movie"===this.listePerso[i].anime.type?s++:e++;this.nbTV=t,this.nbOAV=e,this.nbEp=a,this.nbFilm=s},updateScore:function(t){var e=this;x["a"].axios.post("http://localhost:4000/api/updateScore",{id:e.idUser,animeID:t[1],newScore:t[0]}).then(t=>{console.log(t.data),e.listePerso[t.data.indexToUpdate].score=t.data.score,c["bus"].$emit("updateOverlayInfo"),e.meanScore()}).catch((function(t){console.log(t)}))},delThisAnime2:function(t){var e=this;x["a"].axios.post("http://localhost:4000/api/delAnime",{id:this.idUser,animeID:t}).then((function(t){e.listePerso=t.data,e.stat(),e.meanScore()})).catch((function(t){console.log(t)}))},getMyNewList:function(){var t=this;x["a"].axios.post("http://localhost:4000/api/maListe",{id:this.idUser}).then(e=>{t.listePerso=e.data,t.meanScore(),t.stat()}).catch((function(t){console.log(t)}))},isInListPerso:function(t){for(var e in this.listePerso)if(t===this.listePerso[e].anime.mal_id)return[!0,this.listePerso[e].score];return[!1,0]},async logout(){var t=this;x["a"].axios.post("http://localhost:4000/api/logout").then((function(e){"false"===e.data.connect&&(sessionStorage.setItem("idUser",e.data.session.idUser),sessionStorage.setItem("user",e.data.session.user),sessionStorage.setItem("connecte",e.data.session.connecte),t.$router.push("/"))})).catch((function(t){console.log(t)}))},updateComment:function(t){var e=this;x["a"].axios.post("http://localhost:4000/api/updateComment",{id:e.idUser,animeID:t[1],newComment:t[0]}).then(t=>{e.listePerso[t.data.indexToUpdate].commentaire=t.data.comment,c["bus"].$emit("updateOverlayInfo")}).catch((function(t){console.log(t)}))},retour(){}},created(){null===sessionStorage.getItem("idUser")&&(sessionStorage.setItem("idUser",-1),sessionStorage.setItem("user",""),sessionStorage.setItem("connecte",!1)),this.$vuetify.theme.dark=!0,this.getMyNewList(),c["bus"].$on("delThisAnime2",t=>{this.delThisAnime2(t)}),c["bus"].$on("updateScoreFromOverLay",t=>{this.updateScore([t[0],t[1]])}),c["bus"].$on("updateComment",t=>{this.updateComment([t[0],t[1]])})}},C=_,S=s("7496"),V=s("40dc"),I=s("5bc1"),w=s("8336"),O=s("a75b"),P=s("553a"),A=s("132d"),T=s("8860"),k=s("da13"),N=s("f774"),U=s("2a7f"),$=Object(u["a"])(C,a,i,!1,null,null,null);e["default"]=$.exports;v()($,{VApp:S["a"],VAppBar:V["a"],VAppBarNavIcon:I["a"],VBtn:w["a"],VCard:h["a"],VContent:O["a"],VFooter:P["a"],VIcon:A["a"],VList:T["a"],VListItem:k["a"],VNavigationDrawer:N["a"],VToolbarItems:U["a"],VToolbarTitle:U["b"]})}}]);
//# sourceMappingURL=chunk-2d0dd621.d13934db.js.map