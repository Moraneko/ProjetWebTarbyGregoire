(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd621"],{"80c6":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"inspire"}},[s("v-navigation-drawer",{staticClass:"primary",attrs:{app:"",clipped:"",width:"200"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[s("v-list",[s("v-list-item",{attrs:{to:{name:"Accueil"},color:"black"},on:{click:function(t){return e.retour()}}},[s("div",{staticClass:"d-flex flex-row align-center"},[s("v-icon",{attrs:{color:"white"}},[e._v("home")]),s("h3",{staticClass:"d-flex px-5",staticStyle:{color:"white"}},[e._v("Accueil")])],1)])],1)],1),s("v-app-bar",{staticClass:"primary",attrs:{app:"","clipped-left":""}},[s("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),s("v-toolbar-title",[e._v("Site Tarby-Grégoire")]),s("div",{staticClass:"flex-grow-1"}),e.connected?s("v-toolbar-items",[s("v-btn",{staticClass:"pr-12",attrs:{color:"#f00000"}},[s("v-icon",{staticClass:"px-1 mr-3"},[e._v("mdi-account")]),e._v(e._s(e.userName))],1),s("v-btn",{attrs:{color:"#f00000"},on:{click:e.logout}},[s("v-icon",{staticClass:"px-1 "},[e._v("mdi-close")]),e._v("Deconnexion")],1)],1):s("v-toolbar-items",[s("v-btn",{attrs:{color:"#f00000"}},[e._v("Inscription")]),s("v-btn",{attrs:{color:"#f00000"}},[e._v("Connexion")])],1)],1),s("v-content",{staticClass:"primary"},[s("v-card",{staticClass:"primary d-flex justify-center",attrs:{tile:""}},[s("div",[s("h1",{staticClass:"d-flex justify-center"},[e._v(e._s(e.userName))]),s("h2",{staticClass:"pb-5"},[e._v("Liste de vos animes et statistiques.")])])]),s("div",{staticClass:"d-flex flex-column mx-9 px-9"},[s("v-card",{staticClass:"secondary mx-9 px-9"},[s("div",[s("h1",{staticClass:"d-flex justify-center "},[e._v("Statistiques")])]),s("div",{staticClass:"d-flex justify-space-around"},[s("h2",[e._v("TV: "+e._s(e.nbTV))]),s("h2",[e._v(" OVA: "+e._s(e.nbOAV))]),s("h2",[e._v("Film: "+e._s(e.nbFilm))]),s("h2",[e._v("Episodes: "+e._s(e.nbEp))]),s("h2",[e._v("Score moyen: "+e._s(e.mean)+" ")])])]),s("div",{staticClass:"py-2"}),e._l(e.listePerso,(function(t,a){return s("v-card",{key:a,staticClass:"secondary d-flex flex-column mx-9 my-4"},[s("userAnimeInfo",{attrs:{titre:t.anime.title,added:e.isInListPerso(t.anime.mal_id),index:a,img:t.anime.image_url,score:t.score,connected:e.connected,id:t.anime.mal_id},on:{updateScore:e.updateScore}})],1)}))],2)],1),s("v-footer",{attrs:{app:""}},[s("span",[e._v("© 2019")])])],1)},i=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-card",{staticClass:" secondary d-flex align-center "},[s("v-card",{staticClass:" secondary d-flex flex-row flex-grow-1 align-center ",on:{click:function(t){return e.ouvrirOverlay()}}},[s("div",{staticClass:"d-flex px-12"},[s("v-img",{attrs:{"align-end":"",src:e.img,width:"100",height:"200",raised:"true"}})],1),e.titre.length>50?s("h2",{staticClass:"d-flex text-justify mx-auto"},[e._v(e._s(e.titre.substring(0,50))+"...")]):s("h2",{staticClass:"d-flex text-justify mx-auto"},[e._v(e._s(e.titre))])]),s("div",{staticClass:"d-flex flex-column align-center pr-9 ml-9"},[s("v-rating",{attrs:{value:e.added[1]/2,color:"amber","half-increments":"",hover:"",size:"25"},on:{input:e.updateScore}}),s("div",{staticClass:"grey--text ml-4"},[e._v(e._s(e.added[1]))])],1)],1),s("loadingOverlay",{attrs:{loading:e.loading}}),s("InfoOverlay",{attrs:{overlayVisibility:e.overlayVisibility,connected:e.connected,data:e.apiFetch,id:e.id,added:e.added},on:{fermerOverlay:e.fermerOverlay}})],1)},n=[],r=s("0730"),c=s("fb6e"),l=s("56d7"),d={props:{titre:String,img:String,score:Number,id:Number,index:Number,connected:Boolean,added:Array},components:{InfoOverlay:r["a"],loadingOverlay:c["a"]},data:()=>({overlayVisibility:!1,loading:!1,apiFetch:{}}),methods:{updateScore:function(e){this.$emit("updateScore",[2*e,this.id])},ouvrirOverlay(){this.loading=!0,fetch("https://api.jikan.moe/v3/anime/"+this.id).then(e=>{return e.json()}).then(e=>{this.apiFetch=e,this.loading=!1}).catch(e=>{console.log(e)}),this.overlayVisibility=!0},fermerOverlay(){this.overlayVisibility=!1}},created(){l["bus"].$on("delThisAnime2",e=>{e===this.id&&this.fermerOverlay()})}},m=d,u=s("2877"),v=s("6544"),p=s.n(v),h=s("b0af"),f=s("adda"),g=s("1d4d"),b=Object(u["a"])(m,o,n,!1,null,null,null),y=b.exports;p()(b,{VCard:h["a"],VImg:f["a"],VRating:g["a"]});var x=s("2b0e"),_={components:{userAnimeInfo:y},props:{source:String},data:()=>({nbTV:0,nbFilm:0,nbOAV:0,nbEp:0,mean:0,userName:sessionStorage.getItem("user"),idUser:JSON.parse(sessionStorage.getItem("idUser")),drawer:null,connected:JSON.parse(sessionStorage.getItem("connecte")),appelBool:!1,listePerso:[]}),methods:{meanScore:function(){var e=0,t=0;for(var s in this.listePerso)e+=this.listePerso[s].score,t++;this.mean=Math.trunc(e/t)},stat:function(){var e=0,t=0,s=0,a=0;for(var i in this.listePerso)a+=this.listePerso[i].anime.episodes,"TV"===this.listePerso[i].anime.type?e++:"Movie"===this.listePerso[i].anime.type?s++:t++;this.nbTV=e,this.nbOAV=t,this.nbEp=a,this.nbFilm=s},updateScore:function(e){var t=this;t.idUser>0&&x["a"].axios.post("/api/updateScore",{id:t.idUser,animeID:e[1],newScore:e[0]}).then(e=>{console.log(e.data),t.listePerso[e.data.indexToUpdate].score=e.data.score,l["bus"].$emit("updateOverlayInfo"),t.meanScore()}).catch((function(e){console.log(e)}))},delThisAnime2:function(e){var t=this;t.idUser>0&&x["a"].axios.post("/api/delAnime",{id:this.idUser,animeID:e}).then((function(e){t.listePerso=e.data,t.stat(),t.meanScore()})).catch((function(e){console.log(e)}))},getMyNewList:function(){var e=this;e.idUser>0&&x["a"].axios.post("/api/maListe",{id:this.idUser}).then(t=>{e.listePerso=t.data,e.meanScore(),e.stat()}).catch((function(e){console.log(e)}))},isInListPerso:function(e){for(var t in this.listePerso)if(e===this.listePerso[t].anime.mal_id)return[!0,this.listePerso[t].score];return[!1,0]},async logout(){var e=this;x["a"].axios.post("/api/logout",{}).then((function(t){"false"===t.data.connect&&(sessionStorage.setItem("idUser",t.data.session.idUser),sessionStorage.setItem("user",t.data.session.user),sessionStorage.setItem("connecte",t.data.session.connecte),e.$router.push("/"))})).catch((function(e){console.log(e)}))},updateComment:function(e){var t=this;t.idUser>0&&x["a"].axios.post("/api/updateComment",{id:t.idUser,animeID:e[1],newComment:e[0]}).then(e=>{t.listePerso[e.data.indexToUpdate].commentaire=e.data.comment,l["bus"].$emit("updateOverlayInfo")}).catch((function(e){console.log(e)}))},retour(){}},created(){null===sessionStorage.getItem("idUser")&&(sessionStorage.setItem("idUser",-1),sessionStorage.setItem("user",""),sessionStorage.setItem("connecte",!1)),this.$vuetify.theme.dark=!0,this.getMyNewList(),l["bus"].$on("delThisAnime2",e=>{this.delThisAnime2(e)}),l["bus"].$on("updateScoreFromOverLay",e=>{this.updateScore([e[0],e[1]])}),l["bus"].$on("updateComment",e=>{this.updateComment([e[0],e[1]])})}},C=_,S=s("7496"),V=s("40dc"),I=s("5bc1"),w=s("8336"),O=s("a75b"),P=s("553a"),A=s("132d"),U=s("8860"),T=s("da13"),k=s("f774"),N=s("2a7f"),$=Object(u["a"])(C,a,i,!1,null,null,null);t["default"]=$.exports;p()($,{VApp:S["a"],VAppBar:V["a"],VAppBarNavIcon:I["a"],VBtn:w["a"],VCard:h["a"],VContent:O["a"],VFooter:P["a"],VIcon:A["a"],VList:U["a"],VListItem:T["a"],VNavigationDrawer:k["a"],VToolbarItems:N["a"],VToolbarTitle:N["b"]})}}]);
//# sourceMappingURL=chunk-2d0dd621.88ab8b25.js.map